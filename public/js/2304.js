(self.webpackChunk=self.webpackChunk||[]).push([[2304],{5463:(t,e,s)=>{"use strict";var a=s(538);a="default"in a?a.default:a;var n="2.2.2";/^2\./.test(a.version)||a.util.warn("VueClickaway 2.2.2 only supports Vue 2.x, and does not support Vue "+a.version);var r="_vue_clickaway_handler";function c(t,e,s){o(t);var a=s.context,n=e.value;if("function"==typeof n){var c=!1;setTimeout((function(){c=!0}),0),t[r]=function(e){var s=e.path||(e.composedPath?e.composedPath():void 0);if(c&&(s?s.indexOf(t)<0:!t.contains(e.target)))return n.call(a,e)},document.documentElement.addEventListener("click",t[r],!1)}}function o(t){document.documentElement.removeEventListener("click",t[r],!1),delete t[r]}var l={bind:c,update:function(t,e){e.value!==e.oldValue&&c(t,e)},unbind:o},i={directives:{onClickaway:l}};e.jB=i},2304:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>b});var a=s(7757),n=s.n(a),r=s(5463),c=s(629);function o(t,e,s,a,n,r,c){try{var o=t[r](c),l=o.value}catch(t){return void s(t)}o.done?e(l):Promise.resolve(l).then(a,n)}function l(t){return function(){var e=this,s=arguments;return new Promise((function(a,n){var r=t.apply(e,s);function c(t){o(r,a,n,c,l,"next",t)}function l(t){o(r,a,n,c,l,"throw",t)}c(void 0)}))}}function i(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function u(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?i(Object(s),!0).forEach((function(e){d(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function d(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const v={mixins:[r.jB],components:{NotFound:function(){return s.e(549).then(s.bind(s,549))},DeleteButton:function(){return s.e(2815).then(s.bind(s,2815))}},computed:u(u({},(0,c.Se)({classes:"classs/classes"})),{},{searchButtonDisabled:function(){return""==this.searchForm.class_id},submitButtonDisabled:function(){return""==this.form.class_id||""==this.form.term_id||""==this.form.subject_id||""==this.form.attachment}}),data:function(){return{searchForm:new Form({class_id:""}),subjects:[],routines:[],syllabus_details:[],classes_exam_terms:[],exam_name:"",showSyllabusDetails:!1,syllabuses:[]}},methods:{getTerms:function(){var t=this;return l(n().mark((function e(){var s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,axios.get("/api/syllabuses/".concat(t.searchForm.class_id,"/get-class-exams"));case 3:s=e.sent,t.classes_exam_terms=s.data.exams,e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),t.toastError(e.t0.response.data.message),console.log(e.t0.response.data.errors);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))()},deleteSyllabus:function(t){var e=this;return l(n().mark((function s(){var a;return n().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,axios.delete("/api/syllabuses/".concat(t));case 3:a=s.sent,e.syllabuses.splice(e.syllabuses.findIndex((function(e){return e.id==t})),1),e.toastSuccess(a.data.message),s.next=12;break;case 8:s.prev=8,s.t0=s.catch(0),e.toastError(),console.log(s.t0);case 12:case"end":return s.stop()}}),s,null,[[0,8]])})))()},showDetails:function(t,e){var s=this;return l(n().mark((function a(){var r;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s.showSyllabusDetails=!0,s.exam_name=e,a.prev=2,a.next=5,axios.get("/api/syllabuses/classes/".concat(s.searchForm.class_id,"/terms/").concat(t,"/get-syllabus-details"));case 5:r=a.sent,s.syllabuses=r.data.syllabus_details,s.$refs.syllabusDetails.scrollIntoView({behavior:"smooth",block:"start"}),a.next=14;break;case 10:a.prev=10,a.t0=a.catch(2),s.toastError(a.t0.response.data.message),console.log(a.t0);case 14:case"end":return a.stop()}}),a,null,[[2,10]])})))()},onAttachmentChange:function(t){var e=t.target.files[0];this.form.attachment=e},loadSubjects:function(){var t=this;return l(n().mark((function e(){var s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,axios.get("/api/classes/".concat(t.form.class_id,"/subjects"));case 3:s=e.sent,t.subjects=s.data.subjects,e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),t.toastError(e.t0.response.data.message),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))()},downloadAttachment:function(t){axios({url:"/api/syllabuses/download",method:"POST",responseType:"blob",data:{syllabus_id:t}}).then((function(t){var e=t.data.type.split("/")[1],s=Math.floor(9999999999*Math.random()),a=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=a,n.setAttribute("download","".concat(s,".").concat(e)),document.body.appendChild(n),n.click()})).catch((function(t){console.log(t)}))}},created:function(){this.hasPermisssion("syllabus-list"),this.$store.dispatch("classs/fetchClasses")}};const b=(0,s(1900).Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"page-header d-print-none"},[s("div",{staticClass:"row align-items-center"},[s("div",{staticClass:"col"},[s("h2",{staticClass:"page-title"},[t._v(t._s(t.$route.meta.title))]),t._v(" "),s("h2",{staticClass:"page-pretitle"},[t._v(t._s(t.$t("class_syllabus")))])]),t._v(" "),t.checkPermission("syllabus-create")?s("div",{staticClass:"col-auto ms-auto d-print-none"},[s("div",{staticClass:"d-flex"},[s("router-link",{staticClass:"btn btn-primary btn-outline",attrs:{to:{name:"academic-syllabus-create"}}},[s("icon-plus"),t._v("\n                        "+t._s(t.$t("create"))+"\n                    ")],1)],1)]):t._e()])]),t._v(" "),s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-12"},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-md-3"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.searchForm.class_id,expression:"searchForm.class_id"}],staticClass:"form-control",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.searchForm,"class_id",e.target.multiple?s:s[0])}}},[s("option",{staticClass:"d-none",attrs:{value:""}},[t._v(t._s(t.$t("select_class")))]),t._v(" "),t._l(t.classes,(function(e){return s("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                            "+t._s(e.name)+"\n                        ")])}))],2)]),t._v(" "),t.searchForm.class_id?s("div",{staticClass:"col-md-3"},[s("button",{staticClass:"btn btn-primary btn-outline",attrs:{disabled:t.searchButtonDisabled},on:{click:t.getTerms}},[t._v("\n                        "+t._s(t.$t("get_exam"))+"\n                    ")])]):t._e()])]),t._v(" "),t.classes_exam_terms.length?s("div",{staticClass:"col-12 mt-3"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-header"},[s("h2",{staticClass:"card-title"},[t._v(t._s(t.$t("exam_terms")))])]),t._v(" "),s("div",{staticClass:"card-body table-responsive"},[s("table",{staticClass:"table table-bordered"},[s("thead",[s("tr",[s("th",[t._v(t._s(t.$t("exam_term")))]),t._v(" "),s("th",[t._v(t._s(t.$t("note")))]),t._v(" "),s("th",[t._v(t._s(t.$t("action")))])])]),t._v(" "),s("tbody",t._l(t.classes_exam_terms,(function(e,a){return s("tr",{key:a},[s("td",{staticClass:"col-3"},[t._v(t._s(e.exam.name))]),t._v(" "),s("td",{staticClass:"col-6"},[t._v(t._s(e.exam.note))]),t._v(" "),s("td",{staticClass:"col-3"},[s("a",{staticClass:"btn btn-primary btn-outline",attrs:{href:"#"},on:{click:function(s){return t.showDetails(e.exam_id,e.exam.name)}}},[s("icon-eye"),t._v("\n                                        "+t._s(t.$t("show_details"))+"\n                                    ")],1)])])})),0)])])]),t._v(" "),t.showSyllabusDetails&&t.syllabuses&&t.syllabuses.length?s("div",{ref:"syllabusDetails",staticClass:"card mt-3"},[s("div",{staticClass:"card-header d-flex justify-content-between align-items-center"},[s("h3",{staticClass:"card-title"},[t._v(t._s(t.exam_name)+" "+t._s(t.$t("syllabus")))]),t._v(" "),s("a",{staticClass:"btn btn-danger",attrs:{href:"#"},on:{click:function(e){t.showSyllabusDetails=!1}}},[t._v(t._s(t.$t("close")))])]),t._v(" "),s("div",{staticClass:"card-body"},[t.syllabuses&&t.syllabuses.length?s("table",{staticClass:"table table-responsive"},[s("thead",[s("tr",[s("th",[t._v(t._s(t.$t("subject")))]),t._v(" "),s("th",[t._v(t._s(t.$t("attachment")))]),t._v(" "),s("th",[t._v(t._s(t.$t("Action")))])])]),t._v(" "),s("tbody",t._l(t.syllabuses,(function(e){return s("tr",{key:e.id},[s("td",{attrs:{width:"20%"}},[t._v(t._s(e.subject_name))]),t._v(" "),s("td",{attrs:{width:"20%"}},[e.attachment?s("button",{staticClass:"btn btn-primary btn-outline",attrs:{type:"button"},on:{click:function(s){return t.downloadAttachment(e.id)}}},[s("icon-download"),t._v("\n                                        "+t._s(t.$t("download"))+"\n                                    ")],1):s("button",{staticClass:"btn btn-secondary",attrs:{type:"button",disabled:""}},[t._v("\n                                        "+t._s(t.$t("file_not_found"))+"\n                                    ")])]),t._v(" "),s("td",{attrs:{width:"20%"}},[s("DeleteButton",{attrs:{id:e.id},on:{"delete-data":t.deleteSyllabus}})],1)])})),0)]):s("div",{staticClass:"d-flex justify-content-center py-3"},[s("NotFound",{attrs:{word:"syllabus"}})],1)])]):t._e()]):s("div",{staticClass:"d-flex justify-content-center py-3"},[s("NotFound",{attrs:{word:"class routine"}})],1)])])}),[],!1,null,null,null).exports}}]);