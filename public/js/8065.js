(self.webpackChunk=self.webpackChunk||[]).push([[8065],{5118:(t,e,s)=>{"use strict";s.d(e,{Z:()=>n});var a=s(3645),r=s.n(a)()((function(t){return t[1]}));r.push([t.id,".style-chooser .vs__search::-moz-placeholder{color:#9a9b9a}.style-chooser .vs__search:-ms-input-placeholder{color:#9a9b9a}.style-chooser .vs__search::placeholder{color:#9a9b9a}li.typehead-list.active,li.typehead-list:hover{background-color:#206bc4;color:#fff}",""]);const n=r},8065:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>_});var a=s(7757),r=s.n(a),n=s(7484),o=s.n(n);function i(t,e,s,a,r,n,o){try{var i=t[n](o),c=i.value}catch(t){return void s(t)}i.done?e(c):Promise.resolve(c).then(a,r)}function c(t){return function(){var e=this,s=arguments;return new Promise((function(a,r){var n=t.apply(e,s);function o(t){i(n,a,r,o,c,"next",t)}function c(t){i(n,a,r,o,c,"throw",t)}o(void 0)}))}}function l(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function d(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const u={data:function(){return{keyword:null,guardians:[],studentForm:new Form({name:"",email:"",password:"",class_id:"",section_id:"",parent_id:"",roll_no:"",admission_date:"",gender:"male"}),sections:[]}},computed:function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?l(Object(s),!0).forEach((function(e){d(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},(0,s(629).Se)({classes:"classs/classes"})),mounted:function(){var t=this;return c(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.hasPermisssion("student-create");case 2:return e.next=4,t.dataExistsChecking();case 4:t.$store.dispatch("classs/fetchClasses");case 5:case"end":return e.stop()}}),e)})))()},methods:{getSections:function(){var t=this;return c(r().mark((function e(){var s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.sections=[],e.next=3,axios.get("/api/classes/".concat(t.studentForm.class_id,"/sections"));case 3:s=e.sent,t.sections=s.data.sections;case 5:case"end":return e.stop()}}),e)})))()},setDate:function(t){var e=o()(t).format("YYYY-MM-DD");this.studentForm.admission_date=e},searchGuardian:function(t,e){axios.get("/api/student/guardians?keyword=".concat(escape(t))).then((function(t){console.log(t),e(t.data)})).catch((function(t){console.log(t)}))},addStudent:function(){var t=this;return c(r().mark((function e(){var s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.studentForm.post("/api/students");case 3:s=e.sent,t.$store.commit("student/ADD_STUDENT",s.data.student),t.studentForm.reset(),t.toastSuccess(s.data.message),setTimeout((function(){t.redirect("user-student")}),2e3),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()},sessionChanged:function(){this.$store.dispatch("classs/fetchClasses")},classChanged:function(){var t=this;return c(r().mark((function e(){var s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.sections=[],""!=t.studentForm.class_id){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,axios.get("/api/classes/".concat(t.studentForm.class_id,"/sections"));case 6:s=e.sent,t.sections=s.data.sections,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),t.toastError("Something went wrong while saving data");case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()},dataExistsChecking:function(){var t=this;return c(r().mark((function e(){var s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,axios.get("/api/sessions/year");case 2:null!=(s=e.sent).data.sessions.length&&s.data.selectedSession.default_session_id||(t.redirect("academic-session"),t.toastWarning("Please create and set default session first")),0==t.classes.length&&(t.redirect("academic-class"),t.toastWarning("Please create class first"));case 5:case"end":return e.stop()}}),e)})))()}}};var m=s(3379),v=s.n(m),p=s(5118),f={insert:"head",singleton:!1};v()(p.Z,f);p.Z.locals;const _=(0,s(1900).Z)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"page-header d-print-none"},[s("div",{staticClass:"row align-items-center"},[s("div",{staticClass:"col"},[s("h2",{staticClass:"page-title"},[t._v(t._s(t.$route.meta.title))]),t._v(" "),s("h2",{staticClass:"page-pretitle"},[t._v(t._s(t.$t("student")))])])])]),t._v(" "),s("div",{staticClass:"card"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-header d-flex justify-content-between"},[s("h3",{staticClass:"card-title"},[t._v(t._s(t.$t("create_new_student")))]),t._v(" "),s("Back",{attrs:{routeName:"user-student"}})],1),t._v(" "),s("div",{staticClass:"card-body border-bottom py-3"},[s("form",{attrs:{autocomplete:"off"},on:{submit:function(e){return e.preventDefault(),t.addStudent(e)}}},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-md-6"},[s("div",{staticClass:"form-group row"},[s("div",{staticClass:"col-md-6 mb-3"},[s("label",{staticClass:"form-label"},[t._v(t._s(t.$t("name"))+"\n                                        "),s("span",{staticClass:"text-danger"},[t._v("*")])]),t._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.studentForm.name,expression:"studentForm.name"}],staticClass:"form-control",class:{"is-invalid":t.studentForm.errors.has("name")},attrs:{type:"text",placeholder:t.$t("name")},domProps:{value:t.studentForm.name},on:{input:function(e){e.target.composing||t.$set(t.studentForm,"name",e.target.value)}}}),t._v(" "),s("has-error",{attrs:{form:t.studentForm,field:"name"}})],1)]),t._v(" "),s("div",{staticClass:"col-md-6 mb-3"},[s("label",{staticClass:"form-label"},[t._v(t._s(t.$t("email"))+"\n                                        "),s("span",{staticClass:"text-danger"},[t._v("*")])]),t._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.studentForm.email,expression:"studentForm.email"}],staticClass:"form-control",class:{"is-invalid":t.studentForm.errors.has("email")},attrs:{type:"text",placeholder:t.$t("email")},domProps:{value:t.studentForm.email},on:{input:function(e){e.target.composing||t.$set(t.studentForm,"email",e.target.value)}}}),t._v(" "),s("has-error",{attrs:{form:t.studentForm,field:"name"}})],1)])]),t._v(" "),s("div",{staticClass:"form-group row"},[s("div",{staticClass:"col-md-6 mb-3"},[s("label",{staticClass:"form-label"},[t._v(t._s(t.$t("password"))+"\n                                        "),s("span",{staticClass:"text-danger"},[t._v("*")])]),t._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.studentForm.password,expression:"studentForm.password"}],staticClass:"form-control",class:{"is-invalid":t.studentForm.errors.has("password")},attrs:{type:"password",placeholder:t.$t("enter_password")},domProps:{value:t.studentForm.password},on:{input:function(e){e.target.composing||t.$set(t.studentForm,"password",e.target.value)}}}),t._v(" "),s("has-error",{attrs:{form:t.studentForm,field:"password"}})],1)]),t._v(" "),s("div",{staticClass:"col-md-6 mb-3"},[s("label",{staticClass:"form-label"},[t._v(t._s(t.$t("parent"))+"\n                                        "),s("span",{staticClass:"text-danger"},[t._v("*")])]),t._v(" "),s("div",[s("input",{staticClass:"form-control",class:{"is-invalid":t.studentForm.errors.has("parent_id")},attrs:{id:"guardian_id",type:"text",placeholder:t.$t("choose_a_parent"),autocomplete:"off"}}),t._v(" "),s("typeahead",{attrs:{"match-start":"","append-to-body":!0,target:"#guardian_id","item-key":"name","async-function":t.searchGuardian},scopedSlots:t._u([{key:"item",fn:function(e){return t._l(e.items,(function(a,r){return s("li",{key:r,staticClass:"typehead-list",class:{active:e.activeIndex===r}},[s("a",{attrs:{role:"button"},on:{click:function(t){return e.select(a)}}},[s("img",{attrs:{width:"30px",height:"30px",src:a.image_url}}),t._v(" "),s("span",{domProps:{innerHTML:t._s(e.highlight(a))}})])])}))}}]),model:{value:t.studentForm.parent_id,callback:function(e){t.$set(t.studentForm,"parent_id",e)},expression:"studentForm.parent_id"}}),t._v(" "),s("has-error",{attrs:{form:t.studentForm,field:"parent_id"}})],1)])]),t._v(" "),s("div",{staticClass:"form-group row"},[s("div",{staticClass:"col-md-6 mb-3"},[s("label",{staticClass:"form-label"},[t._v(t._s(t.$t("class"))+"\n                                        "),s("span",{staticClass:"text-danger"},[t._v("*")])]),t._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.studentForm.class_id,expression:"studentForm.class_id"}],staticClass:"form-control mb-0",class:{"is-invalid":t.studentForm.errors.has("class_id")},on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.studentForm,"class_id",e.target.multiple?s:s[0])},t.getSections]}},[s("option",{staticClass:"d-none",attrs:{value:""}},[t._v(t._s(t.$t("select_class")))]),t._v(" "),t._l(t.classes,(function(e){return s("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                                            "+t._s(e.name)+"\n                                        ")])}))],2),t._v(" "),s("has-error",{attrs:{form:t.studentForm,field:"class_id"}})],1),t._v(" "),s("div",{staticClass:"col-md-6 mb-3"},[s("label",{staticClass:"form-label"},[t._v(t._s(t.$t("section"))+"\n                                        "),s("span",{staticClass:"text-danger"},[t._v("*")])]),t._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.studentForm.section_id,expression:"studentForm.section_id"}],staticClass:"form-control mb-0",class:{"is-invalid":t.studentForm.errors.has("section_id")},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.studentForm,"section_id",e.target.multiple?s:s[0])}}},[s("option",{staticClass:"d-none",attrs:{value:""}},[t._v("\n                                            "+t._s(t.$t("select_section"))+"\n                                        ")]),t._v(" "),t._l(t.sections,(function(e){return s("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                                            "+t._s(e.name)+"\n                                        ")])}))],2),t._v(" "),s("has-error",{attrs:{form:t.studentForm,field:"section_id"}})],1)]),t._v(" "),s("div",{staticClass:"form-group row"},[s("div",{staticClass:"col-md-6 mb-3"},[s("label",{staticClass:"form-label"},[t._v(t._s(t.$t("roll_no"))+"\n                                        "),s("span",{staticClass:"text-danger"},[t._v("*")])]),t._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.studentForm.roll_no,expression:"studentForm.roll_no"}],staticClass:"form-control",class:{"is-invalid":t.studentForm.errors.has("roll_no")},attrs:{type:"number",placeholder:t.$t("roll_no")},domProps:{value:t.studentForm.roll_no},on:{input:function(e){e.target.composing||t.$set(t.studentForm,"roll_no",e.target.value)}}}),t._v(" "),s("has-error",{attrs:{form:t.studentForm,field:"roll_no"}})],1)]),t._v(" "),s("div",{staticClass:"col-md-6 mb-3"},[s("label",{staticClass:"form-label"},[t._v(t._s(t.$t("admission_date"))+"\n                                        "),s("span",{staticClass:"text-danger"},[t._v("*")])]),t._v(" "),s("div",[s("date-picker",{attrs:{format:"dd MMMM, yyyy","input-class":"form-control",placeholder:t.$t("select_date"),value:t.studentForm.admission_date},on:{input:function(e){return t.setDate(e)}}}),t._v(" "),s("has-error",{attrs:{form:t.studentForm,field:"admission_date"}})],1)])]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-label"},[t._v(t._s(t.$t("gender")))]),t._v(" "),s("div",[s("label",{staticClass:"form-check form-check-inline"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.studentForm.gender,expression:"studentForm.gender"}],staticClass:"form-check-input",attrs:{type:"radio",value:"male"},domProps:{checked:t._q(t.studentForm.gender,"male")},on:{change:function(e){return t.$set(t.studentForm,"gender","male")}}}),t._v(" "),s("span",{staticClass:"form-check-label"},[t._v(t._s(t.$t("male")))])]),t._v(" "),s("label",{staticClass:"form-check form-check-inline"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.studentForm.gender,expression:"studentForm.gender"}],staticClass:"form-check-input",attrs:{type:"radio",value:"female"},domProps:{checked:t._q(t.studentForm.gender,"female")},on:{change:function(e){return t.$set(t.studentForm,"gender","female")}}}),t._v(" "),s("span",{staticClass:"form-check-label"},[t._v(t._s(t.$t("female")))])])]),t._v(" "),s("has-error",{attrs:{form:t.studentForm,field:"name"}})],1),t._v(" "),s("div",{staticClass:"form-footer text-center"},[s("base-button",{attrs:{loading:t.studentForm.busy}},[t._v(t._s(t.$t("save")))])],1)])])])])])])])}),[],!1,null,null,null).exports}}]);