(self.webpackChunk=self.webpackChunk||[]).push([[3463],{3463:(s,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>n});var t=r(7757),o=r.n(t);function i(s,e,r,t,o,i,a){try{var n=s[i](a),l=n.value}catch(s){return void r(s)}n.done?e(l):Promise.resolve(l).then(t,o)}const a={created:function(){this.$store.getters["rolepermission/userHasPermission"]("role-create")||this.redirect("401")},data:function(){return{roleForm:new Form({name:"",permission:[]})}},methods:{roleSave:function(){var s=this;this.roleForm.post("/api/roles").then((function(e){e.data.success?(s.roleForm.reset(),s.$store.dispatch("rolepermission/loadUserPermissions"),s.toastSuccess(e.data.message)):console.log(123)})).catch((function(e){s.toastError()}))},checkAllPermission:function(s){if(s.target.checked)for(var e in this.roleForm.permission=[],this.permissions)this.roleForm.permission.push(this.permissions[e].id.toString());else this.roleForm.permission=[]}},computed:{permissions:function(){return this.$store.getters["permission/permissions"]}},mounted:function(){var s,e=this;return(s=o().mark((function s(){return o().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,e.hasPermisssion("role-create");case 2:e.$store.dispatch("permission/fetchPermissions");case 3:case"end":return s.stop()}}),s)})),function(){var e=this,r=arguments;return new Promise((function(t,o){var a=s.apply(e,r);function n(s){i(a,t,o,n,l,"next",s)}function l(s){i(a,t,o,n,l,"throw",s)}n(void 0)}))})()}};const n=(0,r(1900).Z)(a,(function(){var s=this,e=s.$createElement,r=s._self._c||e;return r("div",[r("div",{staticClass:"row row-deck row-cards justify-content-center"},[r("div",{staticClass:"col-12"},[r("div",{staticClass:"card"},[r("div",{staticClass:"card-header d-flex justify-content-between align-items-center"},[r("h4",{staticClass:"card-title"},[s._v(s._s(s.$t("add_role")))]),s._v(" "),r("router-link",{staticClass:"btn btn-primary",attrs:{to:{name:"role"}}},[s._v(s._s(s.$t("back")))])],1),s._v(" "),r("div",{staticClass:"card-body border-bottom py-3"},[r("form",{attrs:{autocomplete:"off"},on:{submit:function(e){return e.preventDefault(),s.roleSave(e)}}},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-xl-4"},[r("div",{staticClass:"form-group mb-3 "},[r("label",{staticClass:"form-label"},[s._v(s._s(s.$t("role")))]),s._v(" "),r("div",[r("input",{directives:[{name:"model",rawName:"v-model",value:s.roleForm.name,expression:"roleForm.name"}],staticClass:"form-control",class:{"is-invalid":s.roleForm.errors.has("name")},attrs:{type:"text",placeholder:s.$t("role"),autocomplete:"off"},domProps:{value:s.roleForm.name},on:{input:function(e){e.target.composing||s.$set(s.roleForm,"name",e.target.value)}}}),s._v(" "),r("has-error",{attrs:{form:s.roleForm,field:"name"}})],1)]),s._v(" "),r("div",{staticClass:"form-group mb-3 "},[r("button",{staticClass:"btn btn-primary",attrs:{disabled:s.roleForm.busy,type:"submit"}},[s._v(s._s(s.$t("add")+" "+s.$t("role")))])])]),s._v(" "),r("div",{staticClass:"col-xl-8"},[r("div",{staticClass:"form-group"},[r("label",{staticClass:"form-label"},[s._v(s._s(s.$t("permission")))]),s._v(" "),r("br"),s._v(" "),r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-3"},[r("div",{staticClass:"d-inline-block"},[r("div",[r("label",{staticClass:"form-check"},[r("input",{staticClass:"form-check-input",attrs:{type:"checkbox"},on:{change:function(e){return s.checkAllPermission(e)}}}),s._v(" "),r("span",{staticClass:"form-check-label"},[s._v(s._s(s.$t("all_permission")))]),s._v(" "),r("has-error",{staticClass:"d-block",attrs:{form:s.roleForm,field:"permission"}})],1)])])])]),s._v(" "),r("br"),s._v(" "),r("div",{staticClass:"row"},s._l(s.permissions,(function(e,t){return r("div",{key:t,staticClass:"col-md-3"},[r("div",{staticClass:"d-inline-block mt-1 m-3"},[r("div",[r("label",{staticClass:"form-check"},[r("input",{directives:[{name:"model",rawName:"v-model",value:s.roleForm.permission,expression:"roleForm.permission"}],staticClass:"form-check-input",attrs:{type:"checkbox"},domProps:{value:e.id,checked:Array.isArray(s.roleForm.permission)?s._i(s.roleForm.permission,e.id)>-1:s.roleForm.permission},on:{change:function(r){var t=s.roleForm.permission,o=r.target,i=!!o.checked;if(Array.isArray(t)){var a=e.id,n=s._i(t,a);o.checked?n<0&&s.$set(s.roleForm,"permission",t.concat([a])):n>-1&&s.$set(s.roleForm,"permission",t.slice(0,n).concat(t.slice(n+1)))}else s.$set(s.roleForm,"permission",i)}}}),s._v(" "),r("span",{staticClass:"form-check-label"},[s._v(s._s(e.name))])])])])])})),0)])])])])])])])])])}),[],!1,null,null,null).exports}}]);