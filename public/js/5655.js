(self.webpackChunk=self.webpackChunk||[]).push([[5655],{6035:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>l});var s=t(7757),a=t.n(s);function o(e,r,t,s,a,o,n){try{var i=e[o](n),l=i.value}catch(e){return void t(e)}i.done?r(l):Promise.resolve(l).then(s,a)}function n(e){return function(){var r=this,t=arguments;return new Promise((function(s,a){var n=e.apply(r,t);function i(e){o(n,s,a,i,l,"next",e)}function l(e){o(n,s,a,i,l,"throw",e)}i(void 0)}))}}const i={created:function(){var e=this;return n(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.hasPermisssion("user-edit");case 2:return r.next=4,e.fetchRoles();case 4:return r.next=6,e.fetchUser();case 6:case"end":return r.stop()}}),r)})))()},data:function(){return{userForm:new Form({name:"",email:"",password:"",role:""}),roles:[]}},methods:{userSave:function(){var e=this;return n(a().mark((function r(){var t;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.userForm.put("/api/users/".concat(e.$route.params.userId));case 3:t=r.sent,e.redirect("user"),e.toastSuccess(t.data.message),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(0),e.userForm.errors.record(r.t0);case 11:case"end":return r.stop()}}),r,null,[[0,8]])})))()},fetchRoles:function(){var e=this;return n(a().mark((function r(){var t;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.$store.dispatch("role/fetchRoles");case 2:t=e.allRoles.filter((function(e){return"Student"!==e.name&&"Teacher"!==e.name&&"Guardian"!==e.name&&"Accountant"!==e.name})),e.roles=t;case 4:case"end":return r.stop()}}),r)})))()},fetchUser:function(){var e=this;return n(a().mark((function r(){var t;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,axios.get("/api/users/".concat(e.$route.params.userId));case 2:t=r.sent,e.userForm.name=t.data.name,e.userForm.email=t.data.email,e.userForm.role=t.data.roles[0].id;case 6:case"end":return r.stop()}}),r)})))()}},computed:{allRoles:function(){return this.$store.getters["role/rolesList"]}}};const l=(0,t(1900).Z)(i,(function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[t("div",{staticClass:"page-header d-print-none"},[t("div",{staticClass:"row align-items-center"},[t("div",{staticClass:"col"},[t("h2",{staticClass:"page-title"},[e._v(e._s(e.$route.meta.title))]),e._v(" "),t("h2",{staticClass:"page-pretitle"},[e._v(e._s(e.$t("users")))])])])]),e._v(" "),t("div",{staticClass:"row row-deck row-cards justify-content-center"},[t("div",{staticClass:"col-12"},[t("div",{staticClass:"card"},[t("div",{staticClass:"card-header d-flex justify-content-between"},[t("h3",{staticClass:"card-title"},[e._v(e._s(e.$t("edit_user")))]),e._v(" "),t("Back",{attrs:{routeName:"user"}})],1),e._v(" "),t("div",{staticClass:"card-body border-bottom py-3"},[t("div",{staticClass:"row justify-content-center"},[t("div",{staticClass:"col-md-6"},[t("form",{attrs:{autocomplete:"off"},on:{submit:function(r){return r.preventDefault(),e.userSave(r)}}},[t("div",{staticClass:"form-group mb-3"},[t("label",{staticClass:"form-label"},[e._v(e._s(e.$t("name")))]),e._v(" "),t("div",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.userForm.name,expression:"userForm.name"}],staticClass:"form-control",class:{"is-invalid":e.userForm.errors.has("name")},attrs:{type:"text",placeholder:e.$t("name")},domProps:{value:e.userForm.name},on:{input:function(r){r.target.composing||e.$set(e.userForm,"name",r.target.value)}}}),e._v(" "),t("has-error",{attrs:{form:e.userForm,field:"name"}})],1)]),e._v(" "),t("div",{staticClass:"form-group mb-3"},[t("label",{staticClass:"form-label"},[e._v(e._s(e.$t("email")))]),e._v(" "),t("div",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.userForm.email,expression:"userForm.email"}],staticClass:"form-control",class:{"is-invalid":e.userForm.errors.has("email")},attrs:{type:"email",placeholder:e.$t("email")},domProps:{value:e.userForm.email},on:{input:function(r){r.target.composing||e.$set(e.userForm,"email",r.target.value)}}}),e._v(" "),t("has-error",{attrs:{form:e.userForm,field:"email"}})],1)]),e._v(" "),t("div",{staticClass:"form-group mb-3"},[t("label",{staticClass:"form-label"},[e._v(e._s(e.$t("change_password")))]),e._v(" "),t("div",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.userForm.password,expression:"userForm.password"}],staticClass:"form-control",class:{"is-invalid":e.userForm.errors.has("password")},attrs:{type:"password",placeholder:e.$t("password")},domProps:{value:e.userForm.password},on:{input:function(r){r.target.composing||e.$set(e.userForm,"password",r.target.value)}}}),e._v(" "),t("has-error",{attrs:{form:e.userForm,field:"password"}})],1)]),e._v(" "),t("div",{staticClass:"form-group mb-3"},[t("label",{staticClass:"form-label"},[e._v(e._s(e.$t("role")))]),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.userForm.role,expression:"userForm.role"}],staticClass:"form-control",on:{change:function(r){var t=Array.prototype.filter.call(r.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.userForm,"role",r.target.multiple?t:t[0])}}},[t("option",{staticClass:"d-none",attrs:{value:""}},[e._v(e._s(e.$t("select_role")))]),e._v(" "),e._l(e.roles,(function(r){return t("option",{key:r.id,domProps:{value:r.id}},[e._v("\n                                            "+e._s(r.name)+"\n                                        ")])}))],2),e._v(" "),t("has-error",{attrs:{form:e.userForm,field:"role"}})],1),e._v(" "),t("div",{staticClass:"form-footer text-center"},[t("base-button",{attrs:{loading:e.userForm.busy}},[e._v(e._s(e.$t("save")))])],1)])])])])])])])])}),[],!1,null,null,null).exports}}]);