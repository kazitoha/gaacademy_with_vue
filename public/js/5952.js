(self.webpackChunk=self.webpackChunk||[]).push([[5952],{5952:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>v});var a=s(7757),r=s.n(a),o=s(629),i=s(7484),n=s.n(i);function c(t,e,s,a,r,o,i){try{var n=t[o](i),c=n.value}catch(t){return void s(t)}n.done?e(c):Promise.resolve(c).then(a,r)}function l(t){return function(){var e=this,s=arguments;return new Promise((function(a,r){var o=t.apply(e,s);function i(t){c(o,a,r,i,n,"next",t)}function n(t){c(o,a,r,i,n,"throw",t)}i(void 0)}))}}function d(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function f(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?d(Object(s),!0).forEach((function(e){u(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function u(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const m={data:function(){return{sections:[],students:[],form:new Form({invoice_type:"bulk",type_id:"",class_id:"",section_id:"",student_id:"",amount:"",due_date:"",description:"",status:0,send_notification:!1,title:"",message:""})}},watch:{"form.invoice_type":function(t){"individual"==t&&""!=this.form.class_id&&""!=this.form.section_id?this.loadStudents():this.form.student_id=""},"form.class_id":function(t){"individual"==this.form.invoice_type&&""!=t&&""!=this.form.section_id?this.loadStudents():this.form.student_id=""},"form.section_id":function(t){"individual"==this.form.invoice_type&&""!=this.form.class_id&&""!=t?this.loadStudents():this.form.student_id=""}},computed:f(f({},(0,o.Se)({classes:"classs/classes",feesTypes:"fee/feesType"})),{},{searchButtonDisabled:function(){return""==this.form.class_id||""==this.form.section_id}}),methods:{check:function(t){var e=this;this.$nextTick((function(){console.log(e.form.send_notification,t)}))},setDueDate:function(t){var e=n()(t).format("YYYY-MM-DD");this.form.due_date=e},loadSerachFormSections:function(){var t=this;return l(r().mark((function e(){var s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,axios.get("/api/classes/".concat(t.searchForm.class_id,"/sections"));case 3:s=e.sent,t.sections=s.data.sections,e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),t.toastError(e.t0.response.data.message),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))()},loadSections:function(){var t=this;return l(r().mark((function e(){var s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,axios.get("/api/classes/".concat(t.form.class_id,"/sections"));case 3:s=e.sent,t.sections=s.data.sections,e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),t.toastError(e.t0.response.data.message),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))()},loadStudents:function(){var t=this;return l(r().mark((function e(){var s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,axios.get("/api/classes/".concat(t.form.class_id,"/section/").concat(t.form.section_id,"/students"));case 3:s=e.sent,t.students=s.data.data,e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),t.toastError(e.t0.response.data.message),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))()},save:function(){var t=this;return l(r().mark((function e(){var s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.form.post("/api/fees");case 3:s=e.sent,t.toastSuccess(s.data.message),t.redirect("fees-list"),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),t.toastError(),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))()},dataExistsChecking:function(){var t=this;return l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.feesTypes.length||(t.toastWarning("Please create fee type first"),t.redirect("fees-type")),t.classes.length||(t.toastWarning("Please create class first"),t.redirect("academic-class"));case 2:case"end":return e.stop()}}),e)})))()}},created:function(){var t=this;return l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.hasPermisssion("fee-create");case 2:return e.next=4,t.$store.dispatch("classs/fetchClasses");case 4:return e.next=6,t.$store.dispatch("fee/fetchFeesType");case 6:return e.next=8,t.dataExistsChecking();case 8:case"end":return e.stop()}}),e)})))()}};const v=(0,s(1900).Z)(m,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"page-header d-print-none"},[s("div",{staticClass:"row align-items-center"},[s("div",{staticClass:"col"},[s("h2",{staticClass:"page-title"},[t._v(t._s(t.$route.meta.title))]),t._v(" "),s("h2",{staticClass:"page-pretitle"},[t._v(t._s(t.$t("fees")))])])])]),t._v(" "),s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-12 mt-3"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-body d-flex justify-content-between"},[s("h2",{staticClass:"card-title"},[t._v(t._s(t.$t("fee_allocation")))]),t._v(" "),s("Back",{attrs:{routeName:"fees-list"}})],1),t._v(" "),s("div",{staticClass:"card-body"},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-md-10 col-xl-6"},[s("form",{attrs:{autocomplete:"off"},on:{submit:function(e){return e.preventDefault(),t.save(e)}}},[s("div",{staticClass:"form-group mb-3"},[s("base-label",{attrs:{title:t.$t("invoice_type"),required:!0}}),t._v(" "),s("base-select",{attrs:{form:t.form,field:"invoice_type"},model:{value:t.form.invoice_type,callback:function(e){t.$set(t.form,"invoice_type",e)},expression:"form.invoice_type"}},[s("option",{attrs:{value:"bulk",selected:""}},[t._v(t._s(t.$t("bulk")))]),t._v(" "),s("option",{attrs:{value:"individual"}},[t._v(t._s(t.$t("individual")))])])],1),t._v(" "),s("div",{staticClass:"form-group mb-3"},[s("base-label",{attrs:{title:t.$t("fee_type"),required:!0}}),t._v(" "),s("base-select",{attrs:{form:t.form,field:"type_id"},model:{value:t.form.type_id,callback:function(e){t.$set(t.form,"type_id",e)},expression:"form.type_id"}},[s("option",{staticClass:"d-none",attrs:{value:""}},[t._v("\n                                            "+t._s(t.$t("select_type"))+"\n                                        ")]),t._v(" "),t._l(t.feesTypes,(function(e){return s("option",{key:e.id,domProps:{value:e.id,selected:e.id==t.form.type_id}},[t._v("\n                                            "+t._s(e.name)+"\n                                        ")])}))],2)],1),t._v(" "),s("div",{staticClass:"form-group row"},[s("div",{staticClass:"col-md-6 mb-3"},[s("base-label",{attrs:{title:t.$t("class"),required:!0}}),t._v(" "),s("base-select",{attrs:{form:t.form,field:"class_id"},on:{change:t.loadSections},model:{value:t.form.class_id,callback:function(e){t.$set(t.form,"class_id",e)},expression:"form.class_id"}},[s("option",{staticClass:"d-none",attrs:{value:""}},[t._v("\n                                                "+t._s(t.$t("select_class"))+"\n                                            ")]),t._v(" "),t._l(t.classes,(function(e){return s("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                                                "+t._s(e.name)+"\n                                            ")])}))],2)],1),t._v(" "),s("div",{staticClass:"col-md-6 mb-3"},[s("base-label",{attrs:{title:t.$t("section"),required:!0}}),t._v(" "),s("base-select",{attrs:{form:t.form,field:"section_id"},model:{value:t.form.section_id,callback:function(e){t.$set(t.form,"section_id",e)},expression:"form.section_id"}},[s("option",{staticClass:"d-none",attrs:{value:""}},[t._v("\n                                                "+t._s(t.$t("select_section"))+"\n                                            ")]),t._v(" "),t._l(t.sections,(function(e){return s("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                                                "+t._s(e.name)+"\n                                            ")])}))],2)],1)]),t._v(" "),"bulk"!=t.form.invoice_type?s("div",{staticClass:"form-group mb-3"},[s("base-label",{attrs:{title:t.$t("student"),required:!0}}),t._v(" "),s("base-select",{attrs:{form:t.form,field:"student_id"},model:{value:t.form.student_id,callback:function(e){t.$set(t.form,"student_id",e)},expression:"form.student_id"}},[s("option",{staticClass:"d-none",attrs:{value:""}},[t._v("\n                                            "+t._s(t.$t("select_student"))+"\n                                        ")]),t._v(" "),t._l(t.students,(function(e){return s("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                                            "+t._s(e.name)+"\n                                        ")])}))],2)],1):t._e(),t._v(" "),s("div",{staticClass:"form-group row"},[s("div",{staticClass:"col-md-6 mb-3"},[s("base-label",{attrs:{title:t.$t("amount"),required:!0}}),t._v(" "),s("base-input",{attrs:{form:t.form,field:"amount"},model:{value:t.form.amount,callback:function(e){t.$set(t.form,"amount",e)},expression:"form.amount"}})],1),t._v(" "),s("div",{staticClass:"col-md-6 mb-3"},[s("base-label",{attrs:{title:t.$t("due_date"),required:!0}}),t._v(" "),s("date-picker",{attrs:{format:"dd MMMM, yyyy","input-class":"form-control",placeholder:t.$t("select_date")},on:{input:function(e){return t.setDueDate(e)}}}),t._v(" "),s("has-error",{staticClass:"d-block",attrs:{form:t.form,field:"due_date"}})],1)]),t._v(" "),s("div",{staticClass:"form-group mb-3"},[s("base-label",{attrs:{title:t.$t("status"),required:!0}}),t._v(" "),s("div",[s("label",{staticClass:"form-check form-check-inline"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.status,expression:"form.status"}],staticClass:"form-check-input",attrs:{type:"radio",value:"1"},domProps:{checked:t._q(t.form.status,"1")},on:{change:function(e){return t.$set(t.form,"status","1")}}}),t._v(" "),s("span",{staticClass:"form-check-label"},[t._v(t._s(t.$t("paid")))])]),t._v(" "),s("label",{staticClass:"form-check form-check-inline"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.status,expression:"form.status"}],staticClass:"form-check-input",attrs:{type:"radio",value:"0"},domProps:{checked:t._q(t.form.status,"0")},on:{change:function(e){return t.$set(t.form,"status","0")}}}),t._v(" "),s("span",{staticClass:"form-check-label"},[t._v(t._s(t.$t("unpaid")))])])]),t._v(" "),s("has-error",{staticClass:"d-block",attrs:{form:t.form,field:"name"}})],1),t._v(" "),s("div",{staticClass:"form-group mb-3"},[s("base-label",{attrs:{title:t.$t("description")}}),t._v(" "),s("base-textarea",{attrs:{form:t.form,field:"description",rows:6},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),t._v(" "),s("div",{staticClass:"form-group mb-3"},[s("div",[s("label",{staticClass:"form-check form-check-inline"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.send_notification,expression:"form.send_notification"}],staticClass:"form-check-input",attrs:{type:"checkbox"},domProps:{value:!1,checked:Array.isArray(t.form.send_notification)?t._i(t.form.send_notification,!1)>-1:t.form.send_notification},on:{change:[function(e){var s=t.form.send_notification,a=e.target,r=!!a.checked;if(Array.isArray(s)){var o=t._i(s,false);a.checked?o<0&&t.$set(t.form,"send_notification",s.concat([false])):o>-1&&t.$set(t.form,"send_notification",s.slice(0,o).concat(s.slice(o+1)))}else t.$set(t.form,"send_notification",r)},t.check]}}),t._v(" "),s("span",{staticClass:"form-check-label"},[t._v(t._s(t.$t("send_email_notification")))])])]),t._v(" "),s("has-error",{staticClass:"d-block",attrs:{form:t.form,field:"name"}})],1),t._v(" "),t.form.send_notification?s("div",[s("div",{staticClass:"form-group mb-3"},[s("label",{staticClass:"form-label",attrs:{for:"title"}},[t._v(t._s(t.$t("title")))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.title,expression:"form.title"}],staticClass:"form-control",class:{"is-invalid":t.form.errors.has("title")},attrs:{id:"title"},domProps:{value:t.form.title},on:{input:function(e){e.target.composing||t.$set(t.form,"title",e.target.value)}}}),t._v(" "),s("has-error",{attrs:{form:t.form,field:"title"}})],1),t._v(" "),s("div",{staticClass:"form-group mb-3"},[s("label",{staticClass:"form-label",attrs:{for:"message"}},[t._v(t._s(t.$t("message")))]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.message,expression:"form.message"}],staticClass:"form-control",class:{"is-invalid":t.form.errors.has("message")},attrs:{id:"message",rows:8},domProps:{value:t.form.message},on:{input:function(e){e.target.composing||t.$set(t.form,"message",e.target.value)}}}),t._v(" "),s("has-error",{attrs:{form:t.form,field:"message"}})],1)]):t._e(),t._v(" "),s("div",{staticClass:"form-footer"},[s("base-button",{attrs:{loading:t.form.busy}},[t._v(t._s(t.$t("save")))])],1)])])])])])])])])}),[],!1,null,null,null).exports}}]);